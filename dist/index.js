!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.hyperactiv=t()}(this,function(){"use strict";const e=[],t={timeout:null,queue:new Set,process:()=>{for(let e of t.queue)e();t.queue.clear(),t.timeout=null},enqueue:e=>{null===t.timeout&&(t.timeout=setTimeout(t.process,0)),t.queue.add(e)}};return{observe:function(n,{props:u=null,ignore:o=null,batch:s=!1}={}){return n.__observeMap=new Map,new Proxy(n,{get(t,s){const{__observeMap:r}=n;if(u&&!u.includes(s)||o&&o.includes(s))return n[s];r.has(s)||r.set(s,new Set);const i=r.get(s);return e.length>0&&i.add(e[0]),r.set(s,i),n[s]},set(e,r,i){const{__observeMap:c}=n;if(n[r]=i,u&&!u.includes(r)||o&&o.includes(r))return!0;if(c.has(r)){const e=c.get(r);for(let n of e)n.__disposed?e.delete(n):s?t.enqueue(n):n()}return!0}})},computed:function(t,{autoRun:n=!0}={}){const u=new Proxy(t,{apply:function(t,n,o){const s=(s=null)=>{e.unshift(u);const r=s?s():t.apply(n,o);return e.shift(),r};return o.push({computeAsync:e=>s(e)}),s()}});return n&&u(),u},dispose:e=>e.__disposed=!0}});
