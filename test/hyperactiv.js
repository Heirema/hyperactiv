!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.hyperactiv=t()}(this,function(){"use strict";const e=[],t={timeout:null,queue:new Set,process:()=>{for(let e of t.queue)e();t.queue.clear(),t.timeout=null},enqueue:e=>{null===t.timeout&&(t.timeout=setTimeout(t.process,0)),t.queue.add(e)}};return{observe:function(n,{props:u=null,ignore:o=null,batch:s=!1}={}){return n.__observeMap=new Map,new Proxy(n,{get(t,s){const{__observeMap:r}=n;if(u&&!u.includes(s)||o&&o.includes(s))return n[s];r.has(s)||r.set(s,new Set);const i=r.get(s);return e.length>0&&i.add(e[0]),r.set(s,i),n[s]},set(e,r,i){const{__observeMap:c}=n;if(n[r]===i)return!1;if(n[r]=i,u&&!u.includes(r)||o&&o.includes(r))return!0;if(c.has(r)){const e=c.get(r);for(let n of e)n.__disposed?e.delete(n):s?t.enqueue(n):n()}return!0}})},computed:function(t,{autoRun:n=!0}={}){const u=new Proxy(t,{apply:function(t,n,o){const s=(s=null)=>{e.unshift(u);const r=s?s():t.apply(n,o);return e.shift(),r};return o.push({computeAsync:e=>s(e)}),s()}});return n&&u(),u},dispose:e=>e.__disposed=!0}});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaHlwZXJhY3Rpdi5qcyIsInNvdXJjZXMiOlsiLi4vc3JjL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGNvbXB1dGVkU3RhY2sgPSBbXVxuXG5jb25zdCBjb21wdXRlZCA9IGZ1bmN0aW9uKGZ1biwge8KgYXV0b1J1biA9IHRydWUgfSA9IHt9KSB7XG4gICAgY29uc3QgcHJveHkgPSBuZXcgUHJveHkoZnVuLCB7XG4gICAgICAgIGFwcGx5OiBmdW5jdGlvbih0YXJnZXQsIHRoaXNBcmcsIGFyZ3NMaXN0KSB7XG4gICAgICAgICAgICBjb25zdCBwZXJmb3JtQ29tcHV0YXRpb24gPSAoZnVuID0gbnVsbCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbXB1dGVkU3RhY2sudW5zaGlmdChwcm94eSlcbiAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBmdW4gPyBmdW4oKSA6IHRhcmdldC5hcHBseSh0aGlzQXJnLCBhcmdzTGlzdClcbiAgICAgICAgICAgICAgICBjb21wdXRlZFN0YWNrLnNoaWZ0KClcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGFyZ3NMaXN0LnB1c2goe1xuICAgICAgICAgICAgICAgIGNvbXB1dGVBc3luYzogdGFyZ2V0ID0+IHBlcmZvcm1Db21wdXRhdGlvbih0YXJnZXQpXG4gICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICByZXR1cm4gcGVyZm9ybUNvbXB1dGF0aW9uKClcbiAgICAgICAgfVxuICAgIH0pXG4gICAgaWYoYXV0b1J1bikgeyBwcm94eSgpIH1cbiAgICByZXR1cm4gcHJveHlcbn1cblxuY29uc3QgZGlzcG9zZSA9IF8gPT4gXy5fX2Rpc3Bvc2VkID0gdHJ1ZVxuXG5jb25zdCBiYXRjaGVyID3CoHtcbiAgICB0aW1lb3V0OiBudWxsLFxuICAgIHF1ZXVlOiBuZXcgU2V0KCksXG4gICAgcHJvY2VzczogKCkgPT4ge1xuICAgICAgICBmb3IobGV0IHRhc2sgb2YgYmF0Y2hlci5xdWV1ZSlcbiAgICAgICAgICAgIHRhc2soKVxuICAgICAgICBiYXRjaGVyLnF1ZXVlLmNsZWFyKClcbiAgICAgICAgYmF0Y2hlci50aW1lb3V0ID0gbnVsbFxuICAgIH0sXG4gICAgZW5xdWV1ZTogdGFzayA9PiB7XG4gICAgICAgIGlmKGJhdGNoZXIudGltZW91dCA9PT0gbnVsbClcbiAgICAgICAgICAgIGJhdGNoZXIudGltZW91dCA9IHNldFRpbWVvdXQoYmF0Y2hlci5wcm9jZXNzLCAwKVxuICAgICAgICBiYXRjaGVyLnF1ZXVlLmFkZCh0YXNrKVxuICAgIH1cbn1cblxuY29uc3Qgb2JzZXJ2ZSA9IGZ1bmN0aW9uKG9iaiwgeyBwcm9wcyA9IG51bGwsIGlnbm9yZSA9IG51bGwsIGJhdGNoID0gZmFsc2UgfSA9IHt9KSB7XG4gICAgb2JqLl9fb2JzZXJ2ZU1hcCA9IG5ldyBNYXAoKVxuXG4gICAgcmV0dXJuIG5ldyBQcm94eShvYmosIHtcbiAgICAgICAgZ2V0KF8sIHByb3ApIHtcbiAgICAgICAgICAgIGNvbnN0IHsgX19vYnNlcnZlTWFwIH0gPSBvYmpcblxuICAgICAgICAgICAgaWYoKHByb3BzICYmICFwcm9wcy5pbmNsdWRlcyhwcm9wKSkgfHwgKGlnbm9yZSAmJiBpZ25vcmUuaW5jbHVkZXMocHJvcCkpKVxuICAgICAgICAgICAgICAgIHJldHVybiBvYmpbcHJvcF1cblxuICAgICAgICAgICAgaWYoIV9fb2JzZXJ2ZU1hcC5oYXMocHJvcCkpIHtcbiAgICAgICAgICAgICAgICBfX29ic2VydmVNYXAuc2V0KHByb3AsIG5ldyBTZXQoKSlcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3Qgc2V0ID0gX19vYnNlcnZlTWFwLmdldChwcm9wKVxuICAgICAgICAgICAgaWYoY29tcHV0ZWRTdGFjay5sZW5ndGggPiAwKVxuICAgICAgICAgICAgICAgIHNldC5hZGQoY29tcHV0ZWRTdGFja1swXSlcbiAgICAgICAgICAgIF9fb2JzZXJ2ZU1hcC5zZXQocHJvcCwgc2V0KVxuXG4gICAgICAgICAgICByZXR1cm4gb2JqW3Byb3BdXG4gICAgICAgIH0sXG4gICAgICAgIHNldChfLCBwcm9wLCB2YWx1ZSkge1xuICAgICAgICAgICAgY29uc3QgeyBfX29ic2VydmVNYXAgfSA9IG9ialxuXG4gICAgICAgICAgICBpZihvYmpbcHJvcF0gPT09IHZhbHVlKVxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxuXG4gICAgICAgICAgICBvYmpbcHJvcF0gPSB2YWx1ZVxuXG4gICAgICAgICAgICBpZigocHJvcHMgJiYgIXByb3BzLmluY2x1ZGVzKHByb3ApKSB8fCAoaWdub3JlICYmIGlnbm9yZS5pbmNsdWRlcyhwcm9wKSkpXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWVcblxuICAgICAgICAgICAgaWYoX19vYnNlcnZlTWFwLmhhcyhwcm9wKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGRlcGVuZGVudHMgPSBfX29ic2VydmVNYXAuZ2V0KHByb3ApXG4gICAgICAgICAgICAgICAgZm9yKGxldCBkZXBlbmRlbnQgb2YgZGVwZW5kZW50cykge1xuICAgICAgICAgICAgICAgICAgICBpZihkZXBlbmRlbnQuX19kaXNwb3NlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVwZW5kZW50cy5kZWxldGUoZGVwZW5kZW50KVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYoYmF0Y2gpIGJhdGNoZXIuZW5xdWV1ZShkZXBlbmRlbnQpXG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGRlcGVuZGVudCgpXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgICB9XG4gICAgfSlcbn1cblxuZXhwb3J0IGRlZmF1bHQge1xuICAgIG9ic2VydmUsXG4gICAgY29tcHV0ZWQsXG4gICAgZGlzcG9zZVxufSJdLCJuYW1lcyI6WyJjb21wdXRlZFN0YWNrIiwiYmF0Y2hlciIsInRpbWVvdXQiLCJxdWV1ZSIsIlNldCIsInByb2Nlc3MiLCJ0YXNrIiwiY2xlYXIiLCJlbnF1ZXVlIiwic2V0VGltZW91dCIsImFkZCIsIm9ic2VydmUiLCJvYmoiLCJwcm9wcyIsImlnbm9yZSIsImJhdGNoIiwiX19vYnNlcnZlTWFwIiwiTWFwIiwiUHJveHkiLCJbb2JqZWN0IE9iamVjdF0iLCJfIiwicHJvcCIsImluY2x1ZGVzIiwiaGFzIiwic2V0IiwiZ2V0IiwibGVuZ3RoIiwidmFsdWUiLCJkZXBlbmRlbnRzIiwiZGVwZW5kZW50IiwiX19kaXNwb3NlZCIsImRlbGV0ZSIsImNvbXB1dGVkIiwiZnVuIiwiYXV0b1J1biIsInByb3h5IiwiYXBwbHkiLCJ0YXJnZXQiLCJ0aGlzQXJnIiwiYXJnc0xpc3QiLCJwZXJmb3JtQ29tcHV0YXRpb24iLCJ1bnNoaWZ0IiwicmVzdWx0Iiwic2hpZnQiLCJwdXNoIiwiY29tcHV0ZUFzeW5jIiwiZGlzcG9zZSJdLCJtYXBwaW5ncyI6InNMQUFBLE1BQU1BLEtBeUJBQyxHQUNGQyxRQUFTLEtBQ1RDLE1BQU8sSUFBSUMsSUFDWEMsUUFBUyxLQUNMLElBQUksSUFBSUMsS0FBUUwsRUFBUUUsTUFDcEJHLElBQ0pMLEVBQVFFLE1BQU1JLFFBQ2ROLEVBQVFDLFFBQVUsTUFFdEJNLFFBQVNGLElBQ2tCLE9BQXBCTCxFQUFRQyxVQUNQRCxFQUFRQyxRQUFVTyxXQUFXUixFQUFRSSxRQUFTLElBQ2xESixFQUFRRSxNQUFNTyxJQUFJSixZQXFEdEJLLFFBakRZLFNBQVNDLEdBQUtDLE1BQUVBLEVBQVEsS0FBSUMsT0FBRUEsRUFBUyxLQUFJQyxNQUFFQSxHQUFRLE9BR2pFLE9BRkFILEVBQUlJLGFBQWUsSUFBSUMsSUFFaEIsSUFBSUMsTUFBTU4sR0FDYk8sSUFBSUMsRUFBR0MsR0FDSCxNQUFNTCxhQUFFQSxHQUFpQkosRUFFekIsR0FBSUMsSUFBVUEsRUFBTVMsU0FBU0QsSUFBV1AsR0FBVUEsRUFBT1EsU0FBU0QsR0FDOUQsT0FBT1QsRUFBSVMsR0FFWEwsRUFBYU8sSUFBSUYsSUFDakJMLEVBQWFRLElBQUlILEVBQU0sSUFBSWpCLEtBRy9CLE1BQU1vQixFQUFNUixFQUFhUyxJQUFJSixHQUs3QixPQUpHckIsRUFBYzBCLE9BQVMsR0FDdEJGLEVBQUlkLElBQUlWLEVBQWMsSUFDMUJnQixFQUFhUSxJQUFJSCxFQUFNRyxHQUVoQlosRUFBSVMsSUFFZkYsSUFBSUMsRUFBR0MsRUFBTU0sR0FDVCxNQUFNWCxhQUFFQSxHQUFpQkosRUFFekIsR0FBR0EsRUFBSVMsS0FBVU0sRUFDYixPQUFPLEVBSVgsR0FGQWYsRUFBSVMsR0FBUU0sRUFFUmQsSUFBVUEsRUFBTVMsU0FBU0QsSUFBV1AsR0FBVUEsRUFBT1EsU0FBU0QsR0FDOUQsT0FBTyxFQUVYLEdBQUdMLEVBQWFPLElBQUlGLEdBQU8sQ0FDdkIsTUFBTU8sRUFBYVosRUFBYVMsSUFBSUosR0FDcEMsSUFBSSxJQUFJUSxLQUFhRCxFQUNkQyxFQUFVQyxXQUNURixFQUFXRyxPQUFPRixHQUVmZCxFQUFPZCxFQUFRTyxRQUFRcUIsR0FDckJBLElBSWpCLE9BQU8sTUFPZkcsU0F6RmEsU0FBU0MsR0FBS0MsUUFBRUEsR0FBVSxPQUN2QyxNQUFNQyxFQUFRLElBQUlqQixNQUFNZSxHQUNwQkcsTUFBTyxTQUFTQyxFQUFRQyxFQUFTQyxHQUM3QixNQUFNQyxFQUFxQixDQUFDUCxFQUFNLFFBQzlCakMsRUFBY3lDLFFBQVFOLEdBQ3RCLE1BQU1PLEVBQVNULEVBQU1BLElBQVFJLEVBQU9ELE1BQU1FLEVBQVNDLEdBRW5ELE9BREF2QyxFQUFjMkMsUUFDUEQsR0FPWCxPQUpBSCxFQUFTSyxNQUNMQyxhQUFjUixHQUFVRyxFQUFtQkgsS0FHeENHLE9BSWYsT0FER04sR0FBV0MsSUFDUEEsR0F3RVBXLFFBckVZMUIsR0FBS0EsRUFBRVUsWUFBYSJ9
